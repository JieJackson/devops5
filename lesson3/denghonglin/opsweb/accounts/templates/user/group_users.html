{% extends "public/layout.html" %}

{% block body %}
    <table class="table table-striped table-bordered">
        <caption>
            <a type="button" class="btn btn-primary btn-sm"  href="{% url 'group_list' %}">返回用户组列表</a>
        </caption>
        <caption>
            <h4><center>【{{ groupname }}】成员列表</center></h4>
        </caption>
        <tr>
            <th>序号</th>
            <th>用户ID</th>
            <th>用户名</th>
            <th>邮箱</th>
            <th>操作</th>
        </tr>
        {% for user in group_users %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ user.id }}</td>
                <td>{{ user.username }}</td>
                <td>{{ user.email }}</td>
                <td>
                    <button type="button" class="btn btn-danger btn-sm del_group del_group_user" data='{uid:"{{ user.id }}"}'>删除</button>
                </td>
            </tr>
        {% endfor %}
    </table>
{% endblock %}

{% block js %}
    <script>
        $(function () {
            $(".del_group_user").click(function () {
                var click_obj = $(this)
                var userid = click_obj.attr('data')
                console.log(userid)
                $.ajax({
                    url:"{% url 'show_group_users' %}",
                    type:"DELETE",
                    data:{"uid":uid,"gid":gid},
                    datatype:"json",
                    sucess:function (res) {
                        if (res.status != 0) {
                            swal("操作失败",res.errmsg,"error")
                        }else{
                            swal("操作成功",'',"success")
                        }
                    },
                    beforeSend: function (xhr, settings) {
                        var csrftoken = getCookie('csrftoken');
                        if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                            xhr.setRequestHeader("X-CSRFToken", csrftoken)
                        }
                    }
                })


            })
        })

    </script>
{% endblock %}